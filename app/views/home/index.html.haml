:javascript
  $(function () {
    var qs = #{request.query_string.inspect};
    window.App.trackSearch = new TrackSearch({perPage: #{Track.default_per_page}})
    window.App.eventFeed = new Events({
      app:           window.App,
      currentUserID: #{current_user.id},
      filters:       _.extend({
        user:     #{current_user.id},
        follower: #{current_user.id}
      },
      $.deparam.querystring(qs)),
      updateFilters: {
        follower: #{current_user.id},
        splashes: 1,
      },
    });
    window.Scroll = new EndlessScroll({
      data: App.eventFeed,
      noMoreResults: $('<p/>').
        text(I18n.t('events.all_loaded')).
        addClass('loaded'),
      spinnerContainer: $('.loading-spinner-container'),
    });
    window.suggestedSplashers = new SuggestedSplashersView({
      collection: new SuggestedSplashers(#{
        current_user.recommended_users.to_json
      }),
      el: $('[data-widget = "suggested-users"]').get(0),
      followerID: #{current_user.id},
      splashersCount: #{User::SUGGESTED_USERS_PER_PAGE},
    }).render();
  });

.home
  = render "shared/sidebar"
  #stream-wrap.left
    #stream-feed{:data => {:widget => 'feed'}}
      .streamfeed-top
        .container
          = render "shared/feed_search"
        .feed-settings-tabs
          .avan-bold
            %ul{:data => {:widget => 'filter-following'}}
              %li.ui-tabs-selected
                %a.active{:href => "#following"}= t('events.filters.following')
              %li
                %a{:href => "#everyone"}= t('events.filters.everyone')
              %li
                %a{:href => "#mentions"}= '@' + current_user.nickname
              %li
                %a{:href => "#social"}= t('events.filters.social')
          .line
            %span
          %a.feed-updates-count.no-new.left{:data => {:widget => 'update-count'}}
          =# render "shared/feed_toggles"
      =# render "shared/feed_filter"
      %ul.live-feed{:data => {:widget => 'events'}}
      .loading-spinner-container
  .cl &nbsp;

= once(:first_time_splasher) do
  :javascript
    $(function() {
      var t = new Tutorial().render();

      $('body').append(t.shadeEl);
      $('body').append(t.el);
    });

  %script#tmpl-tutorial{:type => 'text/x-jquery-tmpl'}
    .tutorial-header
      %h1 Splash.FM
    .tutorial-content
      .tutorial-welcome
        %h2= t('tutorial.welcome.title')
        %p.sub= t('tutorial.welcome.sub')
      .tutorial-one
        %h2= t('tutorial.one.title')

        - first, *rest = *t('tutorial.one.body').split(/\n\n/)
        %p.first= first

        - rest.each do |p|
          %p= p
    .tutorial-footer
      .tutorial-pager-absolute

  %script#tmpl-tutorial-relative-pager{:type => 'text/x-jquery-tmpl'}
    %a.tutorial-pager-prev= t('tutorial.pager.prev')
    %span.current-page
    = t('tutorial.pager.of')
    %span.total-pages
    %a.tutorial-pager-next= t('tutorial.pager.next')
